{
  "id": "snapshot_1762427853181_az4yixlss",
  "approvalId": "approval_1762427853176_324byreyp",
  "approvalTitle": "Tasks for remote-server-mcp",
  "version": 1,
  "timestamp": "2025-11-06T11:17:33.181Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document\n\n- [ ] 1. Establish project scaffolding and dependencies\n  - File(s): package.json, tsconfig.json, src/index.ts\n  - Actions: Initialize Node/TypeScript project, install MCP SDK, ssh2, zod, logging, and utility libraries; set up lint/test scripts.\n  - Purpose: Provide baseline structure to implement the MCP server.\n  - _Requirements: 1, 2_\n  - _Prompt: Role: Tooling engineer experienced with MCP servers | Task: Bootstrap TypeScript MCP project with required dependencies and entry point wiring for future components | Restrictions: Keep dependency list minimal, ensure TypeScript strict mode enabled | Success: Project builds, lint/test scripts run, entry point logs ready state._\n\n- [ ] 2. Implement configuration loader and schema validation\n  - File(s): src/config/schema.ts, src/config/loader.ts, src/config/types.ts\n  - Actions: Define HostConfig schema (zod), parse `config.toml` from `~/.config/remote-server-mcp/`, expose reload/watch capability.\n  - Purpose: Ensure remote hosts and auth settings are validated before command execution.\n  - _Requirements: 2_\n  - _Prompt: Role: Backend TypeScript engineer | Task: Build robust loader validating config and surfacing errors with remediation hints | Restrictions: No plaintext secrets stored in repo, support overriding config path via env var | Success: Loader returns typed config, rejects invalid entries, supports hot reload callback._\n\n- [ ] 3. Create SSH transport layer with command execution helpers\n  - File(s): src/transport/remote-transport.ts, src/transport/ssh-transport.ts, src/transport/types.ts\n  - Actions: Define `RemoteTransport` interface; implement SSH transport using ssh2 with connection pooling and per-command channels; handle timeouts and stdout/stderr streaming.\n  - Purpose: Provide abstraction for executing commands on remote servers.\n  - _Requirements: 1, 2_\n  - _Prompt: Role: Node.js engineer familiar with SSH | Task: Implement transport that supports both buffered and streaming execution with configurable timeouts | Restrictions: Avoid global state, ensure proper cleanup on errors | Success: Commands execute successfully against mock SSH server, handles auth failure and timeouts gracefully._\n\n- [ ] 4. Add execution hooks and telemetry logging\n  - File(s): src/hooks/execution-hooks.ts, src/logging/telemetry-logger.ts\n  - Actions: Expose pre/post hook interface with no-op default implementation; implement structured logging (JSON) capturing command start/end, errors, durations.\n  - Purpose: Provide observability and future guardrail integration points.\n  - _Requirements: 3_\n  - _Prompt: Role: Observability-focused engineer | Task: Instrument command lifecycle with logs and hook callbacks | Restrictions: Hooks must be async-safe, logging should handle rotation/size via existing library defaults | Success: Logs show expected fields, hook stubs invoked during execution._\n\n- [ ] 5. Implement MCP command service and tool wiring\n  - File(s): src/services/command-service.ts, src/server.ts\n  - Actions: Implement `runCommand` handler that validates request, resolves host, invokes transport, streams/buffers results, invokes hooks/logging; bootstrap MCP server registering the tool.\n  - Purpose: Expose functionality to AI clients via MCP.\n  - _Requirements: 1, 3_\n  - _Prompt: Role: MCP integration engineer | Task: Wire command service into MCP server with error mapping and structured responses | Restrictions: Maintain clear error codes/messages, support streaming via async generator | Success: MCP client can run commands on configured hosts and receive structured output/errors._\n\n- [ ] 6. Testing and documentation\n  - File(s): tests/config-loader.test.ts, tests/ssh-transport.test.ts, tests/command-service.test.ts, README.md\n  - Actions: Write unit/integration tests using mock SSH server; document configuration format, execution flow, and safety considerations.\n  - Purpose: Validate functionality and guide adopters.\n  - _Requirements: All_\n  - _Prompt: Role: QA/Docs engineer | Task: Provide coverage for critical paths and clear setup docs | Restrictions: Tests must run locally without real secrets, doc examples must avoid exposing credentials | Success: Tests pass in CI, README describes setup/run steps._\n",
  "fileStats": {
    "size": 4248,
    "lines": 44,
    "lastModified": "2025-11-06T11:17:21.280Z"
  },
  "comments": []
}